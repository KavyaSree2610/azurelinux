storage:
  bootType: efi
  disks:
  - partitionTableType: gpt
    maxSize: 4096M
    partitions:
    - id: esp
      type: esp
      start: 1M
      end: 9M
    - id: rootfs
      start: 9M
  fileSystems:
  - deviceId: esp
    type: fat32
    mountPoint:
      path: /boot/efi
      options: umask=0077
  - deviceId: rootfs
    type: ext4
    mountPoint:
      path: /
os:
  resetBootLoaderType: hard-reset
  selinux:
    mode: disabled
  kernelCommandLine:
    extraCommandLine: ro rd.auto=1 net.ifnames=0 lockdown=integrity console=tty0 console=ttyS0 rd.info log_buf_len=1M selinux=0 security=
  users:
  - name: testuser
    sshPublicKeyPaths:
    - id_rsa.pub
    primaryGroup: sudo
    secondaryGroups:
    - sudo
  packages:
    install:
    - squashfs-tools
    - tar
    - device-mapper
    - build-essential
    - kernel-headers
  additionalFiles:
    10-eth0.network:
    - path: /etc/systemd/network/10-eth0.network
      permissions: "644"
scripts:
  postCustomization:
  - content: |
      chown testuser:users /home/testuser/.ssh/authorized_keys
      echo "testuser ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers
    name: "Setting up user access"