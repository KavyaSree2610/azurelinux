storage:
  bootType: efi
  disks:
  - partitionTableType: gpt
    maxSize: 61440M
    partitions:
    - id: esp
      type: esp
      start: 1M
      end: 9M
    - id: rootfs
      start: 9M
  fileSystems:
  - deviceId: esp
    type: fat32
    mountPoint:
      path: /boot/efi
      options: umask=0077
  - deviceId: rootfs
    type: ext4
    mountPoint:
      path: /
os:
  resetBootLoaderType: hard-reset
  selinux:
    mode: disabled
  kernelCommandLine:
    extraCommandLine: ro rd.auto=1 net.ifnames=0 lockdown=integrity console=tty0 console=ttyS0 rd.info log_buf_len=1M selinux=0 security=
  users:
  - name: testuser
    sshPublicKeyPaths:
    - id_rsa.pub
    primaryGroup: sudo
    secondaryGroups:
    - sudo
  packages:
    install:
    - squashfs-tools
    - tar
    - device-mapper
    - git
    - build-essential
    - kernel-headers
    - golang
    - containerd
    - cri-tools
    - acl
    - git
    - make
    - tar
    - wget
    - curl
    - rpm
    - qemu-img
    - golang
    - genisoimage
    - python
    - bison
    - gawk
    - pigz
    - moby-containerd
    - moby-engine
    - docker-buildx
    - docker-cli
    - zstd
    - vim
    - rpm-build
  additionalFiles:
    image-files/configs/10-eth0.network:
    - path: /etc/systemd/network/10-eth0.network
      permissions: "644"
    image-files/scripts/00-configure-docker.sh:
    - path: /home/testuser/00-configure-docker.sh
      permissions: "755"
    image-files/scripts/10-enlist.sh:
    - path: /home/testuser/10-enlist.sh
      permissions: "755"
    image-files/scripts/20-build-pkg.sh:
    - path: /home/testuser/20-build-pkg.sh
      permissions: "755"
scripts:
  postCustomization:
  - content: |
      chown testuser:users /home/testuser/.ssh/authorized_keys
      echo "testuser ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers
    name: "Setting up user access"
